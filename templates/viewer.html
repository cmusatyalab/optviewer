<!doctype html>
<title>Viewer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/smoothness/jquery-ui-1.8.21.custom.css') }}" />      
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='leaflet.css') }}" />
<!--[if lte IE 8]>
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='leaflet.ie.css') }}" />
<![endif]-->
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery-1.7.2.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery-ui-1.8.21.custom.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='leaflet.js') }}"></script>
<style type="text/css">
body { padding: 0; margin: 0; }
html, body, #map { height: 100%; }
#slider { float: right; height: 95%; margin: 10px; }
</style>
<div id="slider"></div>
<div id="map">
{{ lipsum() }}
</div>
<script type="text/javascript">
$(function () {
    var map = new L.Map('map', {
        maxZoom: {{ maxZoom }},
        worldCopyJump: false,
        attributionControl: false,
        center: new L.LatLng(0, 0),
        zoom: 0,
    });
    var visible = [];
    function onload() {
        if (this == visible[0]) {
            while (visible.length > 2) {
                var layer = visible.pop();
                map.removeLayer(layer);
            }
        }
    };
    function new_layer(plane) {
        var layer = new L.TileLayer("{{ url_for('tile') }}{plane}/{z}/{x}/{y}.{{ tile_format }}", {
            noWrap: true,
            attribution: plane,
            plane: plane,
        });
        layer.on('load', onload);
        visible.unshift(layer);
        map.addLayer(layer);
    };
    $("#slider").slider({
        orientation: 'vertical',
        max: {{ nLayers }},
        value: {{ nLayers / 2 }},
        slide: function (event, ui) {
            new_layer(ui.value);
        },
    });
    new_layer($('#slider').slider('value'));
});
</script>

