<!doctype html>
<title>Viewer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/smoothness/jquery-ui-1.8.21.custom.css') }}" />      
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='leaflet.css') }}" />
<!--[if lte IE 8]>
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='leaflet.ie.css') }}" />
<![endif]-->
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery-1.7.2.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery-ui-1.8.21.custom.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='leaflet.js') }}"></script>
<style type="text/css">
body { padding: 0; margin: 0; }
html, body, #map { height: 100%; }
#slider { float: right; height: 95%; margin: 10px; }
</style>
<div id="slider"></div>
<div id="map">
{{ lipsum() }}
</div>
<script type="text/javascript">
$(function () {
    var tile_url = "{{ url_for('tile') }}{plane}/{z}/{x}/{y}.{{ tile_format }}";

    var map = new L.Map('map', {
        maxZoom: {{ maxZoom }},
        worldCopyJump: false,
        attributionControl: false,
        center: new L.LatLng(0, 0),
        zoom: 0,
    });

    var layer = new L.TileLayer(tile_url, {
        noWrap: true,
        plane: {{ nLayers / 2 }},
    });

    $("#slider").slider({
        orientation: 'vertical',
        max: {{ nLayers }},
        value: layer.options.plane,
        slide: function (event, ui) {
            layer.options.plane = ui.value;
            layer.redraw();
            // layer.redraw does a hard reset which removes tiles before they
            // are redrawn so here is a soft-reset variant.
            //if (layer._map) {
            //    layer._reset(false);
            //    layer._update();
            //    map._onTileLayerLoad();
            //}
        },
    });

    map.addLayer(layer);
    map.fitWorld();
});
</script>

